<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>OAZIS | Documents</title> <link rel="icon" type="image/png" href="logo-40x40.png"> <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"> <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.0"></script> <style> @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap'); ::-webkit-scrollbar{width:4px} ::-webkit-scrollbar-track{background:#fff} ::-webkit-scrollbar-thumb{background:#333} ::-webkit-scrollbar-thumb:hover{background:#111} :root{--bg:#f6fbf9;--bg-2:#eef7f4;--soft:#e8f5f1;--primary:#46b3a2;--primary-600:#3aa494;--primary-700:#2c8d7e;--accent:#f4c88f;--ink:#10211c;--muted:#5a746f;--card:#ffffff;--border:rgba(16,33,28,.08);--shadow:0 10px 30px rgba(25,68,60,.08),0 2px 6px rgba(25,68,60,.05);--radius:18px;--radius-sm:12px;--radius-lg:28px;--ring:rgba(70,179,162,.28)} *{box-sizing:border-box;font-family:"Inter" !important} body{margin:0;background:white;color:var(--ink);font-family:"Inter" !important} .app{display:flex;height:100dvh;backdrop-filter:saturate(115%) blur(0px)} .left{width:300px;min-width:240px;max-width:380px;border-right:1px solid var(--border);background:color-mix(in oklab,var(--card) 92%,transparent);display:flex;flex-direction:column} .folders{flex:1;overflow:auto;padding:10px} .folder{display:flex;align-items:center;padding:5px 10px;border-radius:6px;cursor:pointer;transition:0s;border:0;height:40px;margin-bottom:5px;padding-left:14px} .folder:hover{background:#f1f1f1;border-color:none;box-shadow:none} .folder.active{background:#333} .folder.active .name,.folder.active .actions button,.folder.active .badge.count{color:#fff; !important} .folder .name{font-weight:600;display:flex;align-items:center;gap:8px;font-size:14px;color:#222;font-weight:700} .folder .rightbox{display:flex;align-items:center;gap:6px;margin-left:auto} .folder .actions{display:flex;gap:6px;opacity:0;pointer-events:none;transition:0s} .folder:hover .actions{opacity:1;pointer-events:auto} .folder .actions button{border:none;background:transparent;padding:6px 8px;cursor:pointer;color:#333;border-radius:8px;transition:background .12s ease,color .12s ease;display:inline-flex;align-items:center;justify-content:center} .folder .actions button:hover{background:#e1e1e1;color:#222} .folder .count{transition:0s;font-family:"Roboto Mono",monospace !important;color:#222;font-weight:700} .folder.has-actions:hover .count{display:none} .folder .actions svg{width:16px;height:16px;display:block} .createbar{padding:12px;border-top:1px solid var(--border)} button,.button{padding:10px 14px;border:none;background:#333;color:white;border-radius:6px;cursor:pointer;transition:0s;font-weight:700} #btnOpenCreateFolder{width:-webkit-fill-available} button:hover,.button:hover{box-shadow:#f1f1f1} button:active,.button:active{transform:translateY(0);box-shadow:none} button:focus-visible,.button:focus-visible,input:focus-visible,select:focus-visible{outline:none;box-shadow:0 0 0 4px #f1f1f1} .statusBar{padding:12px 14px;border-top:1px solid var(--border);font-size:12px;color:var(--muted);background:color-mix(in oklab,var(--card) 88%,transparent)} .right{flex:1;display:flex;flex-direction:column;min-width:0} .right .toolbar{padding:18px 12px;border-bottom:none;background:color-mix(in oklab,var(--card) 92%,transparent);display:flex;gap:8px;align-items:center;flex-wrap:wrap} .right .toolbar input[type="text"]{padding:10px 12px;border:1px solid var(--border);border-radius:6px;background:white;min-width:320px;flex:auto;transition:0s;width:100%} .right .toolbar button{border-radius:6px} .content{padding:0;overflow:overlay;overflow-x:hidden} table{width:100%;border-collapse:collapse;background:var(--card);border:none;border-radius:0;overflow:hidden;box-shadow:none} th,td{padding:10px 20px;border-bottom:1px solid var(--border);text-align:left;text-transform:uppercase;font-size:14px;padding-right:0} th{background:#fff;font-weight:700;font-size:13px;color:black;user-select:none;cursor:default;padding:12px 20px} th.sortable{cursor:pointer} tbody tr:hover{background:#f1f1f1} .muted{color:var(--muted)} .empty{padding:18px;color:var(--muted)} .grow{flex:1} .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:radial-gradient(1200px 600px at 10% 10%,color-mix(in oklab,var(--primary) 18%,transparent),transparent 40%),radial-gradient(1200px 800px at 90% 90%,color-mix(in oklab,var(--accent) 22%,transparent),transparent 40%),rgba(9,12,11,.45);padding:16px;z-index:1000} .modal.show{display:flex;animation:fadein .18s ease-out} @keyframes fadein{from{opacity:0}to{opacity:1}} .modal-box{width:100%;max-width:520px;background:var(--card);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;box-shadow:0 20px 60px rgba(16,33,28,.18),0 2px 8px rgba(16,33,28,.08);transform:translateY(10px) scale(.98);animation:pop .22s ease-out forwards} @keyframes pop{to{transform:translateY(0) scale(1)}} .modal-head{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:800;display:flex;align-items:center;gap:10px} .modal-head .emoji{font-size:20px} .modal-body{padding:14px 16px;display:grid;gap:12px} .modal-body input,.modal-body select{padding:10px 12px;border:1px solid var(--border);border-radius:var(--radius-sm);background:white} .modal-foot{display:flex;gap:10px;justify-content:flex-end;padding:14px 16px;border-top:1px solid var(--border)} .btn-primary{background:linear-gradient(180deg,color-mix(in oklab,var(--soft) 55%,white) 0%,color-mix(in oklab,var(--bg-2) 65%,white) 100%);border-color:var(--border);color:var(--primary-700)} .btn-danger{background:linear-gradient(180deg,color-mix(in oklab,var(--accent) 25%,white) 0%,color-mix(in oklab,var(--accent) 10%,white) 100%);border-color:var(--border);color:var(--ink)} .btn-success{background:linear-gradient(180deg,color-mix(in oklab,var(--soft) 65%,white) 0%,color-mix(in oklab,var(--bg-2) 50%,white) 100%);border-color:var(--border);color:var(--primary-700)} .badge{display:inline-block;background:transparent;border:none;color:var(--primary-700);border-radius:0;padding:3px 9px;font-size:12px} a{color:var(--primary-700);text-decoration:none} a:hover{text-decoration:underline} .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:linear-gradient(180deg,#fff 0%,color-mix(in oklab,var(--soft) 25%,white) 100%);border:1px solid var(--border)} .toolbar .button-upload{background:#333;border-color:transparent;color:white;font-weight:700;padding:10px 22px} .toolbar .button-upload:hover{box-shadow:0 10px 25px #f1f1f1} .table-actions{display:flex;gap:8px;align-items:center} .icon-btn{display:inline-flex;align-items:center;justify-content:center;padding:6px 8px;border:1px solid var(--border);background:transparent;border-radius:10px;color:var(--muted);cursor:pointer;transition:background .12s ease,color .12s ease,border-color .12s ease,box-shadow .12s ease;text-decoration:none} .icon-btn:hover{background:#333;color:white} .icon-btn svg{width:16px;height:16px;display:block} .folder-separator{height:1px;background:var(--border);margin:8px 6px} @media (max-width:1200px){.left{width:270px}} @media (max-width:900px){.left{width:240px}} @media (max-width:760px){ .app{flex-direction:column} .left{width:100%;min-width:0;max-width:none;border-right:none;border-bottom:1px solid var(--border)} .folders{max-height:240px} .right .toolbar{position:sticky;top:0;z-index:2} .content{padding:10px} th,td{padding:10px 12px} } @media (max-width:600px){ .right .toolbar input[type="text"]{min-width:0;flex:1 1 100%} table{display:block;overflow-x:auto;white-space:nowrap} table th:nth-child(3),table td:nth-child(3),table th:nth-child(4),table td:nth-child(4){display:none} } .brand{display:flex;align-items:center;gap:.75rem;font-weight:800;padding:12px;color:#333} .brand:hover{text-decoration:none !important} .logo{width:40px;height:40px;border-radius:12px;display:grid;place-items:center;background:radial-gradient(circle at 30% 30%,#7ddbcf,var(--primary));color:white;box-shadow:0 8px 20px rgba(70,179,162,.35)} </style> </head> <body> <div class="app"> <aside class="left"> <a href="#" class="brand"> <span class="logo" aria-hidden="true"> <svg width="22" height="22" viewBox="0 0 24 24" fill="none"> <path d="M4 14c5-1 6-8 8-8s3 7 8 8c-3 1-5 4-8 4s-5-3-8-4z" fill="white" opacity=".9"></path> <circle cx="18" cy="6" r="3" fill="#fff" opacity=".7"></circle> </svg> </span> <span>OAZIS <font style="font-weight: 300">| Documents</font></span> </a> <div class="folders" id="foldersList"></div> <div class="statusBar" id="status">Ready</div> </aside> <main class="right"> <div class="toolbar"> <input type="text" id="searchInput" placeholder="Search files"> <div class="grow"></div> </div> <div class="content"> <table id="filesTable"> <thead> <tr> <th class="sortable" data-sort="name" id="thName">Name</th> <th>Type</th> <th>Size</th> <th class="sortable" data-sort="created" id="thCreated">Created</th> <th>Actions</th> </tr> </thead> <tbody id="filesBody"> <tr> <td colspan="5" class="empty">Select a folder or All files.</td> </tr> </tbody> </table> </div> </main> </div> <script> const APPWRITE_ENDPOINT='https://cloud.appwrite.io/v1'; const APPWRITE_PROJECT_ID='oazissebike'; const APPWRITE_BUCKET_ID='oazissebike'; const JSONBIN_BIN_ID='68b9d3d8d0ea881f4071c182'; const JSONBIN_MASTER_KEY='$2a$10$9sO/ja29sMebpWNvsWmp5.dJ6lv7CPeLBMRFaA/cAEwz42ii6qlCS'; const JSONBIN_BASE='https://api.jsonbin.io/v3'; let folders=[]; let activeView={type:'all',index:-1}; let currentFiles=[]; let sortBy='created'; let sortDir='desc'; let searchQuery=''; const client=new Appwrite.Client().setEndpoint(APPWRITE_ENDPOINT).setProject(APPWRITE_PROJECT_ID); const storage=new Appwrite.Storage(client); const statusEl=document.getElementById('status'); const foldersListEl=document.getElementById('foldersList'); const filesBodyEl=document.getElementById('filesBody'); const searchInputEl=document.getElementById('searchInput'); const thName=document.getElementById('thName'); const thCreated=document.getElementById('thCreated'); const metaCache=new Map(); const internalIds=new Set(); function setStatus(msg){statusEl.textContent=msg} function normalizeBasic(s){return String(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'')} function isInternalName(name){const n=normalizeBasic(name).toLowerCase().trim();return n==='interne'} function toNumPosition(p){const n=parseInt(p,10);return Number.isFinite(n)?n:1e9} async function fetchFolders(){ setStatus('Loading folders...'); const res=await fetch(`${JSONBIN_BASE}/b/${JSONBIN_BIN_ID}/latest`,{headers:{'X-Master-Key':JSONBIN_MASTER_KEY,'X-Bin-Meta':'false','Content-Type':'application/json'},cache:'no-store'}); if(!res.ok)throw new Error('Failed to load folders.'); const data=await res.json(); const all=Array.isArray(data.folders)?data.folders:[]; internalIds.clear(); for(const f of all){if(isInternalName(f.name)){for(const id of (f.files||[]))internalIds.add(id)}} const visible=all.filter(f=>!isInternalName(f.name)).slice().sort((a,b)=>toNumPosition(a.position)-toNumPosition(b.position)); folders=visible; setStatus('Folders loaded.'); } function createBadgeEl(n){const s=document.createElement('span');s.className='badge count';s.textContent=String(n);return s} const ICONS={download:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v12"></path><path d="M7 10l5 5 5-5"></path><path d="M5 19h14"></path></svg>'}; function renderFoldersList(){ foldersListEl.innerHTML=''; const allRow=document.createElement('div'); allRow.className='folder'+(activeView.type==='all'?' active':''); allRow.onclick=()=>{activeView={type:'all',index:-1};renderFoldersList();loadFilesForCurrentView()}; const allName=document.createElement('div'); allName.className='name'; allName.textContent='All files'; const allRight=document.createElement('div'); allRight.className='rightbox'; const allCount=createBadgeEl(getAllIds().length); allRight.append(allCount); allRow.append(allName,allRight); foldersListEl.appendChild(allRow); const sepTop=document.createElement('div'); sepTop.className='folder-separator'; foldersListEl.appendChild(sepTop); folders.forEach((f,idx)=>{ const row=document.createElement('div'); row.className='folder'+(activeView.type==='folder'&&activeView.index===idx?' active':''); row.onclick=()=>{activeView={type:'folder',index:idx};renderFoldersList();loadFilesForCurrentView()}; const name=document.createElement('div'); name.className='name'; name.textContent=f.name; const right=document.createElement('div'); right.className='rightbox'; const count=createBadgeEl(Array.isArray(f.files)?f.files.length:0); right.append(count); row.append(name,right); foldersListEl.appendChild(row); }); if(folders.length===0){ const empty=document.createElement('div'); empty.className='empty'; empty.style.padding='12px'; empty.textContent='No folders available.'; foldersListEl.appendChild(empty); } } function formatBytes(bytes){ const sizes=['B','KB','MB','GB','TB']; if(bytes===0)return'0 B'; const i=Math.floor(Math.log(bytes)/Math.log(1024)); return(bytes/Math.pow(1024,i)).toFixed(2)+' '+sizes[i] } function getActiveIds(){ if(activeView.type==='all')return getAllIds(); const f=folders[activeView.index]; return Array.isArray(f?.files)?f.files:[] } function getAllIds(){ const set=new Set(); for(const f of folders){ for(const id of f.files||[]){if(!internalIds.has(id))set.add(id)} } return Array.from(set) } async function ensureMeta(ids){ for(const id of ids){ if(metaCache.has(id))continue; try{ const meta=await storage.getFile(APPWRITE_BUCKET_ID,id); metaCache.set(id,meta); }catch(e){ const errMeta={$id:id,name:`(missing ${id})`,sizeOriginal:0,$createdAt:Date.now(),_error:true}; metaCache.set(id,errMeta); } } } function getDisplayName(raw){ const n=String(raw||''); const idx=n.lastIndexOf('.'); let base=idx>0?n.slice(0,idx):n; base=base.replace(/[_-]+/g,' '); base=base.replace(/\s+/g,' ').trim(); return base||'(unnamed)' } function getExt(raw){ const n=String(raw||''); const idx=n.lastIndexOf('.'); if(idx>0&&idx<n.length-1)return n.slice(idx+1).toLowerCase(); return'' } function applySearchAndSort(items){ let out=items; if(searchQuery){ const q=searchQuery.toLowerCase(); out=out.filter(m=>getDisplayName(m.name).toLowerCase().includes(q)); } out=out.slice().sort((a,b)=>{ if(sortBy==='name'){ const an=getDisplayName(a.name).toLowerCase(); const bn=getDisplayName(b.name).toLowerCase(); if(an<bn)return sortDir==='asc'?-1:1; if(an>bn)return sortDir==='asc'?1:-1; return 0 } if(sortBy==='created'){ const ad=new Date(a.$createdAt||a.dateCreated||0).getTime(); const bd=new Date(b.$createdAt||b.dateCreated||0).getTime(); if(ad<bd)return sortDir==='asc'?-1:1; if(ad>bd)return sortDir==='asc'?1:-1; return 0 } return 0 }); return out } function formatDateOnly(ts){ const d=new Date(ts||Date.now()); return d.toLocaleDateString() } function renderFilesTable(){ filesBodyEl.innerHTML=''; if(currentFiles.length===0){ filesBodyEl.innerHTML=`<tr><td colspan="5" class="empty">No files.</td></tr>`; return; } const filtered=applySearchAndSort(currentFiles); if(filtered.length===0){ filesBodyEl.innerHTML=`<tr><td colspan="5" class="empty">No files match your search.</td></tr>`; return; } for(const meta of filtered){ const id=meta.$id; const tr=document.createElement('tr'); const downloadUrl=storage.getFileDownload(APPWRITE_BUCKET_ID,id); const displayName=getDisplayName(meta.name||''); const ext=getExt(meta.name||''); const createdDate=formatDateOnly(meta.$createdAt||meta.dateCreated||Date.now()); const actionsCell=document.createElement('td'); const actionsWrap=document.createElement('div'); actionsWrap.className='table-actions'; const aDownload=document.createElement('a'); aDownload.className='icon-btn'; aDownload.href=downloadUrl; aDownload.target='_blank'; aDownload.rel='noopener'; aDownload.title='Download'; aDownload.setAttribute('aria-label','Download'); aDownload.innerHTML=ICONS.download; actionsWrap.append(aDownload); actionsCell.append(actionsWrap); tr.innerHTML=`<td>${displayName}</td><td>${ext}</td><td>${formatBytes(meta.sizeOriginal||meta.size||0)}</td><td>${createdDate}</td>`; tr.appendChild(actionsCell); filesBodyEl.appendChild(tr); } } async function loadFilesForCurrentView(){ filesBodyEl.innerHTML=''; const ids=getActiveIds(); if(ids.length===0){ currentFiles=[]; renderFilesTable(); return; } setStatus('Loading files...'); await ensureMeta(ids); currentFiles=ids.map(id=>metaCache.get(id)).filter(Boolean); renderFilesTable(); setStatus('Ready'); } searchInputEl.addEventListener('input',()=>{searchQuery=searchInputEl.value.trim();renderFilesTable()}); function updateSortIndicators(){ thName.textContent='Name'+(sortBy==='name'?(sortDir==='asc'?' ▲':' ▼'):''); thCreated.textContent='Created'+(sortBy==='created'?(sortDir==='asc'?' ▲':' ▼'):''); } function setSort(by){ if(sortBy===by){sortDir=sortDir==='asc'?'desc':'asc'}else{sortBy=by;sortDir=by==='name'?'asc':'desc'} updateSortIndicators(); renderFilesTable(); } thName.classList.add('sortable'); thCreated.classList.add('sortable'); thName.addEventListener('click',()=>setSort('name')); thCreated.addEventListener('click',()=>setSort('created')); updateSortIndicators(); (async function init(){ try{await fetchFolders()}catch(e){setStatus('Failed to load folders.');alert('Failed to load folders: '+e.message)} renderFoldersList(); await loadFilesForCurrentView(); setStatus('Ready'); })(); </script> </body> </html>
